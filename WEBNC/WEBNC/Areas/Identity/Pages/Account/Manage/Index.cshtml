@page
@model IndexModel
@{
    ViewData["Title"] = "H·ªì s∆° c√° nh√¢n";
    ViewData["ActivePage"] = ManageNavPages.Index;
}

<style>
    /* T·ªïng th·ªÉ trang */
    .profile-container {
        background-color: #f8f9fa;
        min-height: 500px;
        border-radius: 15px;
    }

    /* Card thi·∫øt k·∫ø hi·ªán ƒë·∫°i */
    .profile-card {
        border: none;
        border-radius: 1rem;
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.08);
        background: #ffffff;
    }

    .section-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: #0d6efd;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
    }

        .section-title i {
            margin-right: 10px;
        }

    /* T√πy ch·ªânh Select2 ƒë·ªÉ kh·ªõp v·ªõi Bootstrap Floating Labels */
    .select2-container--default .select2-selection--single {
        height: 58px !important;
        display: flex;
        align-items: center;
        border: 1px solid #dee2e6;
        border-radius: 0.5rem !important;
        padding-top: 15px; /* ƒê·∫©y ch·ªØ xu·ªëng ƒë·ªÉ c√¢n b·∫±ng */
    }

    .select2-container--default.select2-container--focus .select2-selection--single {
        border-color: #86b7fe;
        box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
    }

    .select2-container--default .select2-selection__rendered {
        padding-left: 12px !important;
        color: #212529 !important;
    }

    .select2-container--default .select2-selection__arrow {
        height: 56px !important;
    }

    .select2-dropdown {
        border-radius: 0.5rem !important;
        border: 1px solid #86b7fe;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        overflow: hidden;
    }

    /* N√∫t b·∫•m */
    .btn-save {
        padding: 0.8rem 2.5rem;
        font-weight: 600;
        border-radius: 50px;
        transition: all 0.3s;
    }

        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(13, 110, 253, 0.3);
        }
</style>

<div class="container py-5 profile-container">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="mb-4 text-center text-md-start">
                <h2 class="fw-bold"><i class="fas fa-user-circle text-primary me-2"></i>Th√¥ng tin t√†i kho·∫£n</h2>
                <p class="text-muted">Qu·∫£n l√Ω th√¥ng tin c√° nh√¢n v√† ƒë·ªãa ch·ªâ giao h√†ng c·ªßa b·∫°n</p>
            </div>

            <partial name="_StatusMessage" for="StatusMessage" />

            <div class="card profile-card">
                <div class="card-body p-4 p-md-5">
                    <form id="profile-form" method="post">
                        <div asp-validation-summary="ModelOnly" class="text-danger" role="alert"></div>

                        <div class="row g-4">
                            <div class="col-md-6 border-end-md">
                                <h5 class="section-title">
                                    <i class="fas fa-id-card"></i> Th√¥ng tin c∆° b·∫£n
                                </h5>

                                <div class="form-floating mb-3">
                                    <input asp-for="Username" class="form-control bg-light" disabled />
                                    <label asp-for="Username">Email / T√™n ƒëƒÉng nh·∫≠p</label>
                                </div>

                                <div class="form-floating mb-3">
                                    <input asp-for="Input.HoTen" class="form-control" placeholder="H·ªç v√† t√™n" />
                                    <label asp-for="Input.HoTen">H·ªç v√† t√™n</label>
                                    <span asp-validation-for="Input.HoTen" class="text-danger small"></span>
                                </div>

                                <div class="form-floating mb-3">
                                    <input asp-for="Input.PhoneNumber" class="form-control" placeholder="S·ªë ƒëi·ªán tho·∫°i" />
                                    <label asp-for="Input.PhoneNumber">S·ªë ƒëi·ªán tho·∫°i</label>
                                    <span asp-validation-for="Input.PhoneNumber" class="text-danger small"></span>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <h5 class="section-title">
                                    <i class="fas fa-map-marked-alt"></i> ƒê·ªãa ch·ªâ nh·∫≠n h√†ng
                                </h5>

                                <div class="form-floating mb-3">
                                    <input asp-for="Input.SoNha" class="form-control" placeholder="S·ªë nh√†, t√™n ƒë∆∞·ªùng" />
                                    <label asp-for="Input.SoNha">S·ªë nh√†, t√™n ƒë∆∞·ªùng</label>
                                    <span asp-validation-for="Input.SoNha" class="text-danger small"></span>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label small fw-bold text-muted ms-1">Ph∆∞·ªùng/X√£, Qu·∫≠n/Huy·ªán</label>
                                    <select asp-for="Input.IdPhuongXa" class="form-select select2-phuongxa">
                                        <option value="">-- Ch·ªçn Ph∆∞·ªùng/X√£ --</option>
                                    </select>
                                    <span asp-validation-for="Input.IdPhuongXa" class="text-danger small"></span>
                                </div>

                                <div class="p-3 bg-light rounded-3 small text-muted border-start border-primary border-4">
                                    L∆∞u √Ω: ƒê·ªãa ch·ªâ n√†y s·∫Ω ƒë∆∞·ª£c ∆∞u ti√™n s·ª≠ d·ª•ng khi b·∫°n thanh to√°n ƒë∆°n h√†ng nhanh.
                                </div>
                            </div>
                        </div>

                        <hr class="my-4 op-5">

                        <div class="d-flex justify-content-center justify-content-md-end">
                            <button id="update-profile-button" type="submit" class="btn btn-primary btn-save">
                                <i class="fas fa-check-circle me-2"></i>C·∫≠p nh·∫≠t h·ªì s∆°
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <script>
        $(document).ready(function() {
            // Kh·ªüi t·∫°o Select2 v·ªõi c·∫•u h√¨nh ti·∫øng Vi·ªát
            $('.select2-phuongxa').select2({
                width: '100%',
                placeholder: 'üîç T√¨m ki·∫øm Ph∆∞·ªùng/X√£...',
                allowClear: true,
                language: {
                    noResults: function() { return "Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£"; },
                    searching: function() { return "ƒêang t·∫£i d·ªØ li·ªáu..."; }
                }
            });

            // T·∫£i d·ªØ li·ªáu t·ª´ API
            $.ajax({
                url: '/api/DonDatHang/get-phuongxa',
                method: 'GET',
                success: function(data) {
                    var select = $('.select2-phuongxa');

                    // Th√™m d·ªØ li·ªáu v√†o select
                    $.each(data, function(index, item) {
                        var option = new Option(item.text, item.id, false, false);
                        select.append(option);
                    });

                    // T·ª± ƒë·ªông ch·ªçn gi√° tr·ªã hi·ªán t·∫°i c·ªßa User
                    var currentVal = '@Model.Input.IdPhuongXa';
                    if (currentVal) {
                        select.val(currentVal).trigger('change');
                    }
                },
                error: function(err) {
                    console.error("L·ªói khi t·∫£i danh s√°ch Ph∆∞·ªùng/X√£:", err);
                }
            });
        });
    </script>
}